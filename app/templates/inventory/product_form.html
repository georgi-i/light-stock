{% extends "base.html" %}

{% block title %}{% if product %}Edit{% else %}Add{% endif %} Product - IMS{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-6">
        <a href="{% if product %}{{ url_for('inventory.view_product', product_id=product.id) }}{% else %}{{ url_for('inventory.list_products') }}{% endif %}"
           class="text-blue-600 hover:text-blue-700 inline-flex items-center mb-4">
            <svg class="h-5 w-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
            {{ _('Back') }}
        </a>
        <h1 class="text-3xl font-bold text-gray-900">{% if product %}{{ _('Edit Product') }}{% else %}{{ _('Add New Product') }}{% endif %}</h1>
    </div>

    <div class="apple-card p-8">
        <form method="POST" class="space-y-6">
            <!-- Product Name -->
            <div>
                <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                    {{ _('Product Name') }} *
                </label>
                <input type="text"
                       name="name"
                       id="name"
                       required
                       value="{% if product %}{{ product.name }}{% endif %}"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>

            <!-- SKU and Barcode -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="sku" class="block text-sm font-medium text-gray-700 mb-2">
                        SKU *
                    </label>
                    <input type="text"
                           name="sku"
                           id="sku"
                           required
                           value="{% if product %}{{ product.sku }}{% endif %}"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>

                <div>
                    <label for="barcode" class="block text-sm font-medium text-gray-700 mb-2">
                        {{ _('Barcode') }}
                    </label>
                    <input type="text"
                           name="barcode"
                           id="barcode"
                           value="{% if product %}{{ product.barcode or '' }}{% endif %}"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
            </div>

            <!-- Description -->
            <div>
                <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    {{ _('Description') }}
                </label>
                <textarea name="description"
                          id="description"
                          rows="3"
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">{% if product %}{{ product.description or '' }}{% endif %}</textarea>
            </div>

            <!-- Stock Info -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                {% if not product %}
                <div>
                    <label for="quantity" class="block text-sm font-medium text-gray-700 mb-2">
                        {{ _('Initial Quantity') }}
                    </label>
                    <input type="number"
                           name="quantity"
                           id="quantity"
                           min="0"
                           value="0"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                {% endif %}

                <div>
                    <label for="min_stock_level" class="block text-sm font-medium text-gray-700 mb-2">
                        {{ _('Minimum Stock Level') }}
                    </label>
                    <input type="number"
                           name="min_stock_level"
                           id="min_stock_level"
                           min="0"
                           value="{% if product %}{{ product.min_stock_level }}{% else %}10{% endif %}"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>

                <div>
                    <label for="unit_price" class="block text-sm font-medium text-gray-700 mb-2">
                        {{ _('Unit Price (EUR)') }}
                    </label>
                    <input type="number"
                           name="unit_price"
                           id="unit_price"
                           min="0"
                           step="0.01"
                           value="{% if product %}{{ product.unit_price }}{% else %}0.00{% endif %}"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
            </div>

            <!-- Category and Location -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="category_id" class="block text-sm font-medium text-gray-700 mb-2">
                        {{ _('Category') }}
                    </label>
                    <select name="category_id"
                            id="category_id"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">{{ _('No Category') }}</option>
                        {% for category in categories %}
                            <option value="{{ category.id }}" {% if product and product.category_id == category.id %}selected{% endif %}>
                                {{ category.get_name(session.get('language', 'en')) }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div>
                    <label for="location" class="block text-sm font-medium text-gray-700 mb-2">
                        {{ _('Location') }}
                    </label>
                    <input type="text"
                           name="location"
                           id="location"
                           value="{% if product %}{{ product.location or '' }}{% endif %}"
                           placeholder="{{ _('e.g., Warehouse A, Shelf 3') }}"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
            </div>

            <!-- Submit Buttons -->
            <div class="flex space-x-4">
                <button type="submit"
                        class="flex-1 py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 apple-btn">
                    {% if product %}{{ _('Update Product') }}{% else %}{{ _('Add Product') }}{% endif %}
                </button>
                <a href="{% if product %}{{ url_for('inventory.view_product', product_id=product.id) }}{% else %}{{ url_for('inventory.list_products') }}{% endif %}"
                   class="flex-1 py-3 px-4 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 apple-btn text-center">
                    {{ _('Cancel') }}
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
